# PT 種子生成器 v1.1.0

這個插件能夠監控指定目錄下的新增文件，自動為新文件生成種子文件，並可以選擇添加到下載器（qBittorrent 或 Transmission）進行做種。同時，插件還能獲取並顯示 PT 站發布種子時需要填寫的信息。

## ✨ 功能特性

### 🔄 核心功能

- 📂 **智能監控**：實時監控指定目錄下的新增文件/文件夾
- ⚡ **自動生成**：自動為新文件/文件夾生成標準種子文件
- 🌐 **下載器集成**：支持 qBittorrent 和 Transmission 自動做種
- 🏷️ **標籤管理**：自動添加自定義標籤分類管理
- 📊 **PT 信息提取**：智能提取 PT 發布所需的詳細信息
- ⏰ **定時掃描**：可配置定時掃描週期（默認 5 分鐘）
- 👀 **實時監控**：基於文件系統事件的實時響應

### 🔧 高級配置

- 🎛️ **分片大小**：支持自動計算或自定義分片大小
- 🔒 **私有種子**：支持生成 PT 站點要求的私有種子
- 🏷️ **來源標識**：可添加自定義來源標識和註釋
- 📝 **Tracker 管理**：支持多個 Tracker 地址配置
- 🚀 **性能優化**：支持高並發場景和雲端部署
- 📱 **通知系統**：靈活的通知設置（成功/錯誤/重複）

### 🎯 PT 站點支持

- 📋 **信息提取**：自動識別分辨率、編碼、音頻格式、HDR 等
- 🔗 **IMDB 集成**：從 NFO 文件提取 IMDB 鏈接
- 📏 **文件大小**：精確計算並格式化顯示文件大小
- 🔤 **字幕識別**：智能識別中英文字幕信息
- 📺 **來源檢測**：識別 BluRay、WEB-DL、Remux 等來源

## 📋 安裝要求

### 系統要求

- MoviePilot v2.0+ 環境
- Python 3.8+
- 足夠的磁盤空間用於存儲種子文件

### 必要依賴

```
watchdog>=3.0.0      # 文件系統監控
apscheduler>=3.10.1  # 定時任務調度
bencodepy>=0.9.5     # 種子文件編碼
```

### 可選依賴

```
qbittorrent-api>=2023.3.44    # qBittorrent 支持
transmission-rpc>=4.1.0       # Transmission 支持
```

## ⚙️ 配置說明

### 基础設置

| 選項         | 說明                       | 默認值  |
| ------------ | -------------------------- | ------- |
| 啟用插件     | 開啟或關閉插件功能         | `false` |
| 發送通知     | 是否在生成種子時發送通知   | `true`  |
| 立即運行一次 | 保存配置後立即執行一次任務 | `false` |
| 提取 PT 信息 | 自動提取 PT 發布所需信息   | `true`  |

### 目錄設置

| 選項         | 說明                         | 默認值                                |
| ------------ | ---------------------------- | ------------------------------------- |
| 監控目錄     | 需要監控的目錄路徑           | 必填                                  |
| 種子保存目錄 | 生成的種子文件保存位置       | `監控目錄/torrents`                   |
| 排除目錄     | 要排除的目錄，逗號分隔       | `@eaDir,@Recycle,.DS_Store`           |
| 包含擴展名   | 要包含的文件擴展名，逗號分隔 | `.mkv,.mp4,.avi,.rmvb,.mov,.ts,.m2ts` |
| 最小文件大小 | 小於此大小(MB)的文件將被忽略 | `100`                                 |

### 執行設置

| 選項     | 說明                       | 默認值                    |
| -------- | -------------------------- | ------------------------- |
| 執行週期 | 定時掃描目錄的 Cron 表達式 | `*/5 * * * *` (每 5 分鐘) |

### 種子設置

| 選項         | 說明                          | 默認值 |
| ------------ | ----------------------------- | ------ |
| Tracker 列表 | 種子的 Tracker 列表，每行一個 | 空     |
| 分片大小     | 種子分片大小，0 表示自動      | `1MB`  |
| 私有種子     | PT 站點通常需要私有種子       | `true` |
| 來源標識     | 種子來源標識，如站點名稱      | 空     |
| 種子註釋     | 種子註釋信息                  | 空     |

### 下載器設置

| 選項         | 說明                             | 默認值        |
| ------------ | -------------------------------- | ------------- |
| 下載器類型   | 選擇 qBittorrent 或 Transmission | `qbittorrent` |
| 添加到下載器 | 是否自動添加種子到下載器         | `true`        |
| 跳過校驗     | 添加時跳過文件校驗               | `true`        |
| 自動開始     | 添加後自動開始做種               | `false`       |

### qBittorrent 設置

| 選項             | 說明               | 默認值                  |
| ---------------- | ------------------ | ----------------------- |
| qBittorrent 地址 | WebUI 地址         | `http://localhost:8080` |
| 用戶名           | WebUI 登錄用戶名   | `admin`                 |
| 密碼             | WebUI 登錄密碼     | `adminadmin`            |
| 分類             | 自動添加的分類標簽 | 空                      |
| 保存路徑         | 種子下載保存路徑   | 監控目錄                |

### Transmission 設置

| 選項     | 說明                  | 默認值      |
| -------- | --------------------- | ----------- |
| 主機     | Transmission 主機地址 | `localhost` |
| 端口     | RPC 端口號            | `9091`      |
| 用戶名   | RPC 用戶名            | 空          |
| 密碼     | RPC 密碼              | 空          |
| 下載目錄 | 種子下載目錄          | 監控目錄    |

### 高級設置

| 選項       | 說明                             | 默認值        |
| ---------- | -------------------------------- | ------------- |
| 種子標籤   | 為種子添加的標籤，逗號分隔       | `PT,AutoSeed` |
| 上傳限速   | 上傳速度限制(KB/s)，0 表示無限制 | `0`           |
| 下載限速   | 下載速度限制(KB/s)，0 表示無限制 | `0`           |
| 分享率限制 | 分享率限制，0 表示無限制         | `0.0`         |
| 做種時限   | 做種時間限制(小時)，0 表示無限制 | `0`           |

### 通知設置

| 選項     | 說明                   | 默認值  |
| -------- | ---------------------- | ------- |
| 成功通知 | 種子生成成功時發送通知 | `true`  |
| 錯誤通知 | 出現錯誤時發送通知     | `true`  |
| 重複通知 | 發現重複種子時發送通知 | `false` |

### PT 信息設置

| 選項          | 說明                     | 默認值  |
| ------------- | ------------------------ | ------- |
| 複製到剪貼板  | 自動複製 PT 信息到剪貼板 | `false` |
| 生成 NFO 文件 | 為媒體生成 NFO 描述文件  | `false` |

## 🚀 使用指南

### 基本使用

1. 在插件配置中設置監控目錄
2. 配置種子保存目錄（可選，默認為監控目錄/torrents）
3. 設置 Tracker 列表
4. 選擇並配置下載器（qBittorrent 或 Transmission）
5. 啟用插件並保存配置

### 進階使用

1. **自定義分片大小**：根據文件大小選擇合適的分片大小
2. **標籤管理**：使用標籤對不同類型的種子進行分類
3. **通知配置**：根據需要配置不同類型的通知
4. **限速設置**：為避免影響其他應用，可設置上傳/下載限速

### API 使用

插件提供以下 API 接口：

- `GET /run` - 立即運行種子生成任務
- `POST /generate` - 為指定路徑生成種子文件
- `POST /info` - 獲取 PT 發布信息
- `GET /status` - 獲取插件狀態

### 命令支持

- `/ptseeder` - 手動掃描目錄並生成種子
- `/ptseeder_info` - 獲取 PT 發布信息
- `/ptseeder_status` - 查看插件狀態

## 📊 PT 站點發布信息提取

插件能夠從文件/目錄名稱和內容中自動提取以下信息：

### 視頻信息

- **分辨率**：2160p、1080p、720p、576p、480p、4K、8K
- **視頻編碼**：H.265、H.264、x265、x264、HEVC、AVC
- **HDR 格式**：HDR10+、HDR10、HDR、Dolby Vision、DV

### 音頻信息

- **音頻格式**：DTS-X、DTS-HD、DTS、TrueHD、Atmos、AC3、AAC、FLAC、PCM

### 來源信息

- **來源類型**：BluRay、UHD BluRay、WEB-DL、WEBRip、HDTV、DVDRip、Remux

### 字幕信息

- **簡體中文**：简体、CHS、SC
- **繁體中文**：繁体、繁體、CHT、TC
- **雙語字幕**：中英、中日
- **英文字幕**：ENG、English

### 其他信息

- **文件大小**：自動計算並格式化顯示（MB/GB/TB）
- **IMDB 鏈接**：從 NFO 文件自動提取 IMDB ID 並生成鏈接

## ⚠️ 注意事項

### 使用建議

1. **監控目錄**：確保監控目錄路徑正確且可訪問
2. **權限設置**：確保 MoviePilot 有讀寫監控目錄和種子保存目錄的權限
3. **磁盤空間**：預留足夠的磁盤空間存儲種子文件
4. **網絡設置**：如果使用下載器功能，確保網絡連接正常

### 性能優化

1. **文件過濾**：合理設置文件擴展名過濾和最小文件大小
2. **排除目錄**：添加系統目錄到排除列表
3. **分片大小**：根據文件大小選擇合適的分片大小
4. **並發處理**：插件支持高並發場景，適合大量文件處理

### 故障排除

1. **種子生成失敗**：檢查文件權限和磁盤空間
2. **下載器連接失敗**：驗證下載器配置和網絡連接
3. **監控不工作**：確認監控目錄路徑和權限
4. **通知不發送**：檢查 MoviePilot 通知配置

## 🔄 更新日志

### v1.1.0 (2025-01-XX)

- ✨ 新增詳細配置項，支持精細化配置
- 🔧 完善錯誤處理和異常恢復機制
- 📊 增強 PT 信息提取，支持更多格式識別
- 🚀 優化性能，支持高並發場景
- ☁️ 兼容 Google Cloud Run 和 GKE 水平擴展
- 🎨 提升用戶體驗，界面更友好
- 🔔 增加靈活的通知設置選項
- 📝 完善 API 接口和命令支持

### v1.0.0 (2025-01-XX)

- 🎉 首個正式版本發布
- 📂 支持目錄監控和自動種子生成
- 🌐 集成 qBittorrent 和 Transmission
- 📋 基礎 PT 站發布信息提取功能

## 📄 許可證

本項目採用 GPL-3.0 許可證 - 查看 [LICENSE](../../LICENSE) 文件瞭解詳情

## 🤝 貢獻

歡迎提交 Issue 和 Pull Request 來幫助改進插件！

## 👨‍💻 作者

- **NikoYu** - [GitHub](https://github.com/yujiajie01)

---

如果這個插件對您有幫助，請給個 ⭐ Star 支持一下！
